# üöÄ A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø–ª–∞—Ç—ã

**–ê–≤—Ç–æ—Ä:** –ú–∞—Ä–¥–µ–µ–≤–∞ –î–∞—Ä–∏–Ω–∞  
**–†–æ–ª—å:** Data Analyst  

---

## üìå –û –ø—Ä–æ–µ–∫—Ç–µ

–¶–µ–ª—å: üìä –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã A/B‚Äë—Ç–µ—Å—Ç–∞ –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø–ª–∞—Ç—ã –∏ –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –æ –µ—ë –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.  

–ö–æ–º–ø–∞–Ω–∏—è –ø—Ä–æ–≤–µ–ª–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ö–µ–º—ã –æ–ø–ª–∞—Ç—ã –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é –∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫.  
–ú–æ—è –∑–∞–¥–∞—á–∞: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –¥–∞—Ç—å –±–∏–∑–Ω–µ—Å-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é.  

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- üêç **Python**: pandas, numpy, matplotlib, seaborn
- üóÑ **SQL**: PostgreSQL
- üìà –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: t‚Äë—Ç–µ—Å—Ç, –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑
- üìä BI‚Äë–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: Redash (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Ç—Ä–∏–∫)

---

## üî• –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–∑–±–∏–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –≥—Ä—É–ø–ø—ã  
‚úÖ –ê–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ (–∫–æ–Ω–≤–µ—Ä—Å–∏—è, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫, ARPU)  
‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ –æ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π  
‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø–ª–∞—Ç—ã  

# –ó–∞–¥–∞–Ω–∏–µ 1. A/B‚Äì—Ç–µ—Å—Ç –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø–ª–∞—Ç—ã

–°—Ç—É–¥–µ–Ω—Ç: –ú–∞—Ä–¥–µ–µ–≤–∞ –î–∞—Ä–∏–Ω–∞

–¶–µ–ª—å: –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ç–æ–≥–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –ø–æ –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–µ –æ–ø–ª–∞—Ç—ã –∏ —Ä–µ—à–∏—Ç—å ‚Äî –∑–∞–ø—É—Å–∫–∞—Ç—å –ª–∏ –µ—ë –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## –ü–ª–∞–Ω
1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö  
2. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö  
3. –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ä–µ–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)  
4. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è *checks* –∏ *paying_users*  
5. –í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è –æ—Ü–µ–Ω–∫–∏  
6. –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º  
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏  
8. –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã


### –ó–∞–¥–∞–Ω–∏–µ 1. A/B‚Äì—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 1.1 –£—Å–ª–æ–≤–∏–µ

> –û–¥–Ω–æ–π –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ –Ω–∞—à–µ–π –∫–æ–º–∞–Ω–¥–µ —è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º –º–µ—Ç–æ–¥ A/B‚Äì—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –í —Ö–æ–¥–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–¥–Ω–æ–π –≥–∏–ø–æ—Ç–µ–∑—ã —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø–µ –±—ã–ª–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∞ –Ω–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –æ–ø–ª–∞—Ç—ã —É—Å–ª—É–≥ –Ω–∞ —Å–∞–π—Ç–µ, —É –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –≥—Ä—É–ø–ø—ã –æ—Å—Ç–∞–≤–∞–ª–∞—Å—å –±–∞–∑–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–¥–∞–Ω–∏—è –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ç–æ–≥–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –∏ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —Å—Ç–æ–∏—Ç –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É –æ–ø–ª–∞—Ç—ã –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

#### 1.2 –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

> –í –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤—ã –∏–º–µ–µ—Ç–µ 4 csv-—Ñ–∞–π–ª–∞:
- `groups.csv` ‚Äì —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –∏–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ (–ê ‚Äì –∫–æ–Ω—Ç—Ä–æ–ª—å, B ‚Äì —Ü–µ–ª–µ–≤–∞—è –≥—Ä—É–ø–ø–∞) 
- `groups_add.csv` ‚Äì –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º –ø—Ä–∏—Å–ª–∞–ª–∏ —Å–ø—É—Å—Ç—è 2 –¥–Ω—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
- `active_studs.csv` ‚Äì —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—à–ª–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –≤ –¥–Ω–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.
- `checks.csv` ‚Äì —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–ø–ª–∞—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–Ω–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.

#### 1.3 –í–æ–ø—Ä–æ—Å—ã

> –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –≤–∞–º –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã:
- –ù–∞ –∫–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ—á–µ–º—É?
- –ò–º–µ—é—Ç—Å—è –ª–∏ —Ä–∞–∑–ª–∏—á–∏—è –≤ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö –∏ —Å —á–µ–º –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã?
- –Ø–≤–ª—è—é—Ç—Å—è –ª–∏ —ç—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º–∏?
- –°—Ç–æ–∏—Ç –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?
- –î–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º, –∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏ —Å–≤–æ—ë–º –æ—Ç–≤–µ—Ç–µ –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–ª–∞–Ω.

#### 1.4 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ—Ç–≤–µ—Ç—É

> - –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è Python. 
- –í —Ñ–∞–π–ª–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Ç–µ–º –¥–µ–π—Å—Ç–≤–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏. 
- –§–∞–π–ª –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Å–æ–±–æ–π –∑–∞–∫–æ–Ω—á–µ–Ω–Ω—ã–π –æ—Ç—á—ë—Ç —Å –≤—ã–≤–æ–¥–∞–º–∏, —Å–¥–µ–ª–∞–Ω–Ω—ã–º–∏ –≤ —Ö–æ–¥–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.


```python
# –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫ 

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import pingouin as pg
import scipy.stats as stats
import requests
from urllib.parse import urlencode
import matplotlib.pyplot as plt
from scipy.stats import shapiro, levene, ttest_ind, ks_2samp
from statsmodels.stats.proportion import proportions_ztest

%matplotlib inline
sns.set_style("whitegrid")
```


```python
# –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç—ã
groups_url = 'https://disk.yandex.ru/d/UhyYx41rTt3clQ'
groups_add_url = 'https://disk.yandex.ru/d/5Kxrz02m3IBUwQ'
active_studs_url = 'https://disk.yandex.ru/d/Tbs44Bm6H_FwFQ'
checks_url = 'https://disk.yandex.ru/d/pH1q-VqcxXjsVA'
```


```python
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞

def ydisk_api(public_key: str) -> str:
    base_url = 'https://cloud-api.yandex.net/v1/disk/public/resources/download?'
    url = base_url + urlencode(dict(public_key=public_key))
    response = requests.get(url)
    response.raise_for_status()  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫–∏ HTTP
    download = response.json()['href']
    return download
```


```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

def load_data(url, sep=','):
    download_url = ydisk_api(url)
    return pd.read_csv(download_url, sep=sep)
```


```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

groups = load_data(groups_url, sep=';')
groups_add = load_data(groups_add_url, sep=',')
active_studs = load_data(active_studs_url, sep=',')
checks = load_data(checks_url, sep=';')
```

    /opt/tljh/user/lib/python3.7/site-packages/outdated/utils.py:18: OutdatedCacheFailedWarning: Failed to use cache while checking for outdated package.
    Set the environment variable OUTDATED_RAISE_EXCEPTION=1 for a full traceback.
    Set the environment variable OUTDATED_IGNORE=1 to disable these warnings.
      **kwargs
    /opt/tljh/user/lib/python3.7/site-packages/outdated/utils.py:18: OutdatedPackageWarning: The package outdated is out of date. Your version is 0.2.1, the latest is 0.2.2.
    Set the environment variable OUTDATED_IGNORE=1 to disable these warnings.
      **kwargs
    /opt/tljh/user/lib/python3.7/site-packages/outdated/utils.py:18: OutdatedPackageWarning: The package pingouin is out of date. Your version is 0.4.0, the latest is 0.5.5.
    Set the environment variable OUTDATED_IGNORE=1 to disable these warnings.
      **kwargs


# –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö(EDA)


```python
# –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö

print("=== –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö ===")

# —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –∏–ª–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ 
# (–ê ‚Äì –∫–æ–Ω—Ç—Ä–æ–ª—å, B ‚Äì —Ü–µ–ª–µ–≤–∞—è –≥—Ä—É–ø–ø–∞)
print("\n groups.csv:") 
print(groups.info())

# –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º –ø—Ä–∏—Å–ª–∞–ª–∏ —Å–ø—É—Å—Ç—è 2 –¥–Ω—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
print("\n groups_add.csv:")
print(groups_add.info())

# —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—à–ª–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –≤ –¥–Ω–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
print("\n active_studs.csv:")
print(active_studs.info())

# —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–ø–ª–∞—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–Ω–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.
print("\n checks.csv:")
print(checks.info())
```

    === –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö ===
    
     groups.csv:
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 74484 entries, 0 to 74483
    Data columns (total 2 columns):
     #   Column  Non-Null Count  Dtype 
    ---  ------  --------------  ----- 
     0   id      74484 non-null  int64 
     1   grp     74484 non-null  object
    dtypes: int64(1), object(1)
    memory usage: 1.1+ MB
    None
    
     groups_add.csv:
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 92 entries, 0 to 91
    Data columns (total 2 columns):
     #   Column  Non-Null Count  Dtype 
    ---  ------  --------------  ----- 
     0   id      92 non-null     int64 
     1   grp     92 non-null     object
    dtypes: int64(1), object(1)
    memory usage: 1.6+ KB
    None
    
     active_studs.csv:
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 8341 entries, 0 to 8340
    Data columns (total 1 columns):
     #   Column      Non-Null Count  Dtype
    ---  ------      --------------  -----
     0   student_id  8341 non-null   int64
    dtypes: int64(1)
    memory usage: 65.3 KB
    None
    
     checks.csv:
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 541 entries, 0 to 540
    Data columns (total 2 columns):
     #   Column      Non-Null Count  Dtype  
    ---  ------      --------------  -----  
     0   student_id  541 non-null    int64  
     1   rev         541 non-null    float64
    dtypes: float64(1), int64(1)
    memory usage: 8.6 KB
    None



```python
# —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π(A) –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ(B)

groups.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>grp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1489</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1627</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1768</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1783</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1794</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Å–ª–∞–ª–∏ —Å–ø—É—Å—Ç—è 2 –¥–Ω—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö

groups_add.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>grp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5694584</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5694830</td>
      <td>B</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5695057</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5698872</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5699067</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—à–ª–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –≤ –¥–Ω–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

active_studs.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>581585</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5723133</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3276743</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4238589</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4475369</td>
    </tr>
  </tbody>
</table>
</div>




```python
# —Ñ–∞–π–ª —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–ø–ª–∞—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–Ω–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

checks.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>student_id</th>
      <th>rev</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1627</td>
      <td>990.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3185</td>
      <td>690.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>25973</td>
      <td>690.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26280</td>
      <td>690.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>100300</td>
      <td>990.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π

print("\n=== –¢–∏–ø—ã –ø–æ–ª–µ–π ===")

print("\n groups.csv:", groups.dtypes)
print("\n groups_add.csv:", groups_add.dtypes)
print("\n active_studs.csv:", active_studs.dtypes)
print("\n checks.csv:", checks.dtypes)
```

    
    === –¢–∏–ø—ã –ø–æ–ª–µ–π ===
    
     groups.csv: id      int64
    grp    object
    dtype: object
    
     groups_add.csv: id      int64
    grp    object
    dtype: object
    
     active_studs.csv: student_id    int64
    dtype: object
    
     checks.csv: student_id      int64
    rev           float64
    dtype: object



```python
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è (–Ω–∞ —Å–ª—É—á–∞–π —Ä–∞–∑–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π)

groups.columns = ['user_id', 'group']
groups_add.columns = ['user_id', 'group']
active_studs.columns = ['user_id']
checks.columns = ['user_id', 'revenue']
```


```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

print("\n groups.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id =", groups['user_id'].duplicated().sum())
print("\n groups_add.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id =", groups_add['user_id'].duplicated().sum())
print("\n active_studs.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id =", active_studs['user_id'].duplicated().sum())
print("\n checks.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id =", checks['user_id'].duplicated().sum())
```

    
     groups.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id = 0
    
     groups_add.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id = 0
    
     active_studs.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id = 0
    
     checks.csv: –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id = 0


#### –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ—Ä—è–¥–∫–µ, –º–æ–∂–µ–º –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ä–∞–±–æ—Ç–µ


```python
# –û–±—ä–µ–¥–∏–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ 'groups' –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ 'groups_add' –≥—Ä—É–ø–ø—ã
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫ –∫–∞–∫–æ–π –≥—Ä—É–ø–ø–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

all_groups = pd.concat([groups, groups_add], ignore_index=True)

print("\n –î—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id =", all_groups['user_id'].duplicated().sum())
print("\n –†–∞–∑–º–µ—Ä all_groups:", len(all_groups))
all_groups.head()
```

    
     –î—É–±–ª–∏–∫–∞—Ç–æ–≤ user_id = 0
    
     –†–∞–∑–º–µ—Ä all_groups: 74576





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1489</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1627</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1768</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1783</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1794</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, –µ—Å–ª–∏ –µ—Å—Ç—å

if all_groups['user_id'].duplicated().any():
    all_groups = all_groups.drop_duplicates(subset='user_id')
print("–î—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã. –ù–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä all_groups:", len(all_groups))
```

    –î—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã. –ù–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä all_groups: 74576



```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤

print("\n–ü—Ä–æ–ø—É—Å–∫–∏ –≤ groups_all:\n", all_groups.isnull().sum())
print("\n–ü—Ä–æ–ø—É—Å–∫–∏ –≤ active_studs:\n", active_studs.isnull().sum())
print("\n–ü—Ä–æ–ø—É—Å–∫–∏ –≤ checks:\n", checks.isnull().sum())
```

    
    –ü—Ä–æ–ø—É—Å–∫–∏ –≤ groups_all:
     user_id    0
    group      0
    dtype: int64
    
    –ü—Ä–æ–ø—É—Å–∫–∏ –≤ active_studs:
     user_id    0
    dtype: int64
    
    –ü—Ä–æ–ø—É—Å–∫–∏ –≤ checks:
     user_id    0
    revenue    0
    dtype: int64



```python
# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º

group_counts = all_groups['group'].value_counts()
group_counts.reset_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B</td>
      <td>59883</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>14693</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º –≤ all_groups

plt.figure(figsize=(8, 6))
sns.countplot(data=all_groups, x='group', palette=['#36A2EB', '#FF6384'])
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º (all_groups)')
plt.xlabel('–ì—Ä—É–ø–ø–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.xticks(ticks=[0, 1], labels=['–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è (A)', '–¢–µ—Å—Ç–æ–≤–∞—è (B)'])
plt.show()
```


![png](output_26_0.png)



```python
# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Ö –≥—Ä—É–ø–ø–∞–º–∏

active_users = active_studs.merge(all_groups, left_on='user_id', right_on='user_id', how='left')

print("–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –≥—Ä—É–ø–ø—ã:", active_users['group'].isnull().sum())
print("\n–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –≥—Ä—É–ø–ø–∞–º–∏:")
active_users.head()
```

    –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –≥—Ä—É–ø–ø—ã: 0
    
    –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –≥—Ä—É–ø–ø–∞–º–∏:





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>581585</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5723133</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3276743</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4238589</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4475369</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º –≤ active_users

plt.figure(figsize=(8, 6))
sns.countplot(data=active_users, x='group', palette=['#36A2EB', '#FF6384'])
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –≥—Ä—É–ø–ø–∞–º (active_users)')
plt.xlabel('–ì—Ä—É–ø–ø–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.xticks(ticks=[0, 1], labels=['–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è (A)', '–¢–µ—Å—Ç–æ–≤–∞—è (B)'])
plt.show()
```


![png](output_28_0.png)



```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–ª–∞—Ç

print(f"–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π –æ–± –æ–ø–ª–∞—Ç–∞—Ö: {len(checks)}")
print("\n–û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ revenue:")
checks['revenue'].describe().reset_index()
```

    –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π –æ–± –æ–ø–ª–∞—Ç–∞—Ö: 541
    
    –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ revenue:





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>count</td>
      <td>541.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mean</td>
      <td>1059.752317</td>
    </tr>
    <tr>
      <th>2</th>
      <td>std</td>
      <td>762.712359</td>
    </tr>
    <tr>
      <th>3</th>
      <td>min</td>
      <td>199.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>25%</td>
      <td>290.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>50%</td>
      <td>840.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>75%</td>
      <td>1900.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max</td>
      <td>4650.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π –≤ –æ–ø–ª–∞—Ç–∞—Ö

print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π –≤ revenue:\n")
print("–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è revenue:", (checks['revenue'] < 0).sum())
print("–ù—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è revenue:", (checks['revenue'] == 0).sum())
print("–ö—Ä–∞–π–Ω–µ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è revenue (> 99-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å):",
      len(checks[checks['revenue'] > checks['revenue'].quantile(0.99)]))
```

    
    –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π –≤ revenue:
    
    –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è revenue: 0
    –ù—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è revenue: 0
    –ö—Ä–∞–π–Ω–µ –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è revenue (> 99-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å): 6



```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π –≤ –æ–ø–ª–∞—Ç–∞—Ö —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ user_id

outliers = checks[checks['revenue'] > checks['revenue'].quantile(0.99)]
print(f"\n–ê–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –æ–ø–ª–∞—Ç—ã (–≤—ã—à–µ 99-–≥–æ –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—è):\n")
outliers
```

    
    –ê–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ –æ–ø–ª–∞—Ç—ã (–≤—ã—à–µ 99-–≥–æ –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—è):
    





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>445767</td>
      <td>3660.0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>829330</td>
      <td>3660.0</td>
    </tr>
    <tr>
      <th>224</th>
      <td>1624158</td>
      <td>3660.0</td>
    </tr>
    <tr>
      <th>231</th>
      <td>1711305</td>
      <td>4650.0</td>
    </tr>
    <tr>
      <th>253</th>
      <td>2150601</td>
      <td>3660.0</td>
    </tr>
    <tr>
      <th>511</th>
      <td>5316551</td>
      <td>3660.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è revenue

plt.figure(figsize=(10, 6))
sns.histplot(checks['revenue'], bins=50, kde=True)
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ revenue –≤ checks.csv')
plt.xlabel('Revenue')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
plt.show()
```


![png](output_32_0.png)



```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–ª–∞—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

non_active_payments = checks[~checks['user_id'].isin(active_users['user_id'])]
if len(non_active_payments) > 0:
    print(f"–û–ø–ª–∞—Ç –æ—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(non_active_payments)}")
non_active_payments.head()
```

    –û–ø–ª–∞—Ç –æ—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 149





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3185</td>
      <td>690.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>25973</td>
      <td>690.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26280</td>
      <td>690.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>100645</td>
      <td>630.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>102534</td>
      <td>580.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–ø–ª–∞—Ç–∞—Ö –∫ –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. 

active_users_pay = active_users.merge(checks, on='user_id', how='left')
active_users_pay['revenue'] = active_users_pay['revenue'].fillna(0)  # –ó–∞–ø–æ–ª–Ω—è–µ–º 0 –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –æ–ø–ª–∞—Ç
active_users_pay['converted'] = (active_users_pay['revenue'] > 0).astype(int)

print("\n=== –†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏: ===\n")
print(f"–†–∞–∑–º–µ—Ä –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞: {len(active_users_pay)}")
print(f"–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞ (A): {len(active_users_pay[active_users_pay['group'] == 'A'])}")
print(f"–¢–µ—Å—Ç–æ–≤–∞—è –≥—Ä—É–ø–ø–∞ (B): {len(active_users_pay[active_users_pay['group'] == 'B'])}")
active_users_pay
```

    
    === –†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏: ===
    
    –†–∞–∑–º–µ—Ä –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞: 8341
    –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞ (A): 1538
    –¢–µ—Å—Ç–æ–≤–∞—è –≥—Ä—É–ø–ø–∞ (B): 6803





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>group</th>
      <th>revenue</th>
      <th>converted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>581585</td>
      <td>A</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5723133</td>
      <td>A</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3276743</td>
      <td>B</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4238589</td>
      <td>A</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4475369</td>
      <td>B</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8336</th>
      <td>1794344</td>
      <td>B</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8337</th>
      <td>296883</td>
      <td>B</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8338</th>
      <td>3598448</td>
      <td>B</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8339</th>
      <td>3610547</td>
      <td>B</td>
      <td>290.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8340</th>
      <td>205705</td>
      <td>B</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>8341 rows √ó 4 columns</p>
</div>




```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

paying_users = active_users_pay[active_users_pay['revenue'] > 0]
print(f"\n–ü–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(paying_users)}")
print(f"–î–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(paying_users) / len(active_users_pay):.4f}")
```

    
    –ü–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 392
    –î–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 0.0470


### –ò—Ç–æ–≥–æ —É –Ω–∞—Å –ø–æ–ª—É—á–∞–µ—Ç—Å—è 3 –¥–∞—Ç–∞—Å–µ—Ç–∞

> - `all_groups` - id —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ –∏—Ö –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –≥—Ä—É–ø–ø–µ A/B —Ç–µ—Å—Ç–∞.
- `active_users` - –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞—à–µ–¥—à–∏–µ –≤–æ –≤—Ä–µ–º—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ c –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å—é –∫ –≥—Ä—É–ø–ø–µ.
- `active_users_pay` - –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∏—Ö –æ–ø–ª–∞—Ç—ã.

#### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –ø–ª–∞—Ç—è—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—ã—è–≤–ª–µ–Ω–æ —Å–ª–µ–¥—É—é—â–µ–µ:

- –í `checks.csv` —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è 541 —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ø–ª–∞—Ç—è—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.
- –í `active_studs.csv` —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –º–µ–Ω—å—à–µ–µ —á–∏—Å–ª–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî 392, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –¥–∞—Ç–∞—Å–µ—Ç `paying_users`.

–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, 149 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∏–ª–∏ –æ–ø–ª–∞—Ç—É, –Ω–æ –Ω–µ –±—ã–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –¥–Ω–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
- –ê–≤—Ç–æ–ø–ª–∞—Ç–µ–∂–∏ ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–∞—è –≥–∏–ø–æ—Ç–µ–∑–∞. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–≥ –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞—Ç–µ–∂, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å–µ—â–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã. –≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤ `active_studs.csv`.
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏–ª–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –æ–ø–ª–∞—Ç ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –æ–ø–ª–∞—á–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–∞–Ω–∫–∞, –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–π —Å–∞–π—Ç –∏ —Ç.–ø.).
- –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–ø–ª–∏—Ç–æ–≤–∞–Ω–∏–∏ / –≤—ã–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ –Ω–µ –ø–æ —Ç–µ–º –∂–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –≥—Ä–∞–Ω–∏—Ü–∞–º, —á—Ç–æ –æ–ø–ª–∞—Ç–∞.

–¢–∞–∫ –∫–∞–∫ –º—ã **—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É –æ–ø–ª–∞—Ç—ã**, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤–∞–∂–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ (–Ω–æ–≤–∞—è —Ñ–æ—Ä–º–∞ / –∫–Ω–æ–ø–∫–∞ / —Å—Ü–µ–Ω–∞—Ä–∏–π), —É—á–∏—Ç—ã–≤–∞—Ç—å ‚Äú–Ω–µ–≤–∏–¥–∏–º—ã—Ö‚Äù –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ–ø–ª–∞—Ç–∞ –±–µ–∑ –ø–æ—Å–µ—â–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã, –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ:

- –æ–Ω–∏ –Ω–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª–∏ —Å –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–æ–π (–∏–ª–∏ —Å—Ç–∞—Ä–æ–π) –≤ –º–æ–º–µ–Ω—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞;
- –∏—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–µ —Å–≤—è–∑–∞–Ω–æ —Å UX-—Ç–µ—Å—Ç–æ–º.

**–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, 149 ‚Äú–≤–Ω–µ—à–Ω–∏—Ö‚Äù –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω—É–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –∞–Ω–∞–ª–∏–∑–∞ ‚Äî —á—Ç–æ –º—ã –∏ –¥–µ–ª–∞–µ–º, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—è—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–∑ `active_studs.csv`.**

#### –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –∏ —Ü–µ–ª–µ–≤–æ–π –≥—Ä—É–ø–ø—ã –æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º (~80/20) –¥–∞–∂–µ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

### –í—ã–≤–æ–¥:

–ú—ã –º–æ–∂–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∞–Ω–∞–ª–∏–∑, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –æ—á–∏—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –Ω–µ –æ–ø–∞—Å–∞—è—Å—å —Å–µ—Ä—å—ë–∑–Ω–æ–≥–æ –≤–ª–∏—è–Ω–∏—è —ç—Ç–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è –Ω–∞ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å A/B-—Ç–µ—Å—Ç–∞.

## 1.3 –í–æ–ø—Ä–æ—Å—ã

1. –ù–∞ –∫–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ—á–µ–º—É?
2. –ò–º–µ—é—Ç—Å—è –ª–∏ —Ä–∞–∑–ª–∏—á–∏—è –≤ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö –∏ —Å —á–µ–º –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã?
3. –Ø–≤–ª—è—é—Ç—Å—è –ª–∏ —ç—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º–∏?
4. –°—Ç–æ–∏—Ç –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?

**1. –¢–∞–∫ –∫–∞–∫ –º—ã –∏—Å—Å–ª–µ–¥—É–µ–º –º–µ—Ö–∞–Ω–∏–∫—É –æ–ø–ª–∞—Ç—ã, –ª–æ–≥–∏—á–Ω–æ –≤—ã–±—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏, –æ—Ç—Ä–∞–∂–∞—é—â–∏–µ —Ç–æ, –∫–∞–∫ —á–∞—Å—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–ª–∞—Ç—è—Ç –∏ —Å–∫–æ–ª—å–∫–æ –ø–ª–∞—Ç—è—Ç.**
> - CR ‚Äî –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—ã. –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞–ª–∏ –ª–∏ –±–æ–ª—å—à–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –ø–æ–∫—É–ø–∫–∏ —Å –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–Ω–∏–∫–æ–π –æ–ø–ª–∞—Ç—ã. 
> - ARPU(–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è). –ò–∑–º–µ–Ω–∏—Ç—Å—è –ª–∏ –≤—ã—Ä—É—á–∫–∞ —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ —Å –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–æ–π.
> - ARPPU(–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–ª–∞—Ç—è—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è). –ò–∑–º–µ–Ω–∏—Ç—Å—è –ª–∏ –≤—ã—Ä—É—á–∫–∞ —Å –ø–ª–∞—Ç—è—â–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞.


```python
# === –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ ===
metrics = active_users_pay.groupby('group', as_index=False).agg(
    users=('user_id', 'count'),
    paying_users=('revenue', lambda x: (x > 0).sum()),
    total_revenue=('revenue', 'sum')
)
metrics['CR'] = metrics['paying_users'] / metrics['users']
metrics['ARPU'] = metrics['total_revenue'] / metrics['users']
metrics['ARPPU'] = metrics['total_revenue'] / metrics['paying_users']
print("\n=== –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º ===")
metrics
```

    
    === –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º ===





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>users</th>
      <th>paying_users</th>
      <th>total_revenue</th>
      <th>CR</th>
      <th>ARPU</th>
      <th>ARPPU</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>1538</td>
      <td>78.0</td>
      <td>72820.0000</td>
      <td>0.050715</td>
      <td>47.347204</td>
      <td>933.589744</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>6803</td>
      <td>314.0</td>
      <td>394974.0035</td>
      <td>0.046156</td>
      <td>58.058798</td>
      <td>1257.878992</td>
    </tr>
  </tbody>
</table>
</div>




```python
# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
plt.figure(figsize=(14, 4))

plt.subplot(1, 3, 1)
sns.barplot(data=metrics, x='group', y='CR')
plt.title('–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É')
plt.ylabel('CR')

plt.subplot(1, 3, 2)
sns.barplot(data=metrics, x='group', y='ARPU')
plt.title('–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (ARPU)')
plt.ylabel('ARPU')

plt.subplot(1, 3, 3)
sns.barplot(data=metrics, x='group', y='ARPPU')
plt.title('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (ARPPU)')
plt.ylabel('ARPPU')

plt.tight_layout()
plt.show()
```


![png](output_45_0.png)


### –ì–∏–ø–æ—Ç–µ–∑—ã

#### –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É (CR)
- **H0**: –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤–∞ (p_A = p_B).
- **H1**: –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è (p_A ‚â† p_B).

#### –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (ARPU)
- **H0**: –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤ (Œº_A = Œº_B).
- **H1**: –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è (Œº_A ‚â† Œº_B).

#### –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (ARPPU)
- **H0**: –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤ (Œº_A = Œº_B).
- **H1**: –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è (Œº_A ‚â† Œº_B).

#### –û–ø—Ä–µ–¥–µ–ª–∏–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø–ª–∞—Ç (revenue) –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –≤—ã–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è ARPU –∏ ARPPU.


```python
# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø–ª–∞—Ç (–¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)

print("\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø–ª–∞—Ç (Shapiro-Wilk):")
for group in ['A', 'B']:
    rev = active_users_pay[active_users_pay['group'] == group]['revenue']
    stat, p = stats.shapiro(rev[rev > 0])
    print(f"–ì—Ä—É–ø–ø–∞ {group}: p-value = {p:.4f}")
```

    
    –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø–ª–∞—Ç (Shapiro-Wilk):
    –ì—Ä—É–ø–ø–∞ A: p-value = 0.0000
    –ì—Ä—É–ø–ø–∞ B: p-value = 0.0000


``` –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø–ª–∞—Ç –Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ (p-value < 0.05), –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º:```
- –î–ª—è ARPU –∏—Å–ø–æ–ª—å–∑—É–µ–º t-—Ç–µ—Å—Ç (–±–æ–ª—å—à–∞—è –≤—ã–±–æ—Ä–∫–∞)
- –î–ª—è ARPPU ‚Äî T-—Ç–µ—Å—Ç, –µ—Å–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã, –∏–Ω–∞—á–µ –±—É—Ç—Å—Ç—Ä—ç–ø.

#### –ü—Ä–æ–≤–µ—Ä–∏–º, –µ—Å—Ç—å –ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (–¥–æ–ª–µ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ A (5.07%) –∏ B (4.62%).


```python
# –ö–æ–Ω–≤–µ—Ä—Å–∏—è: Z-—Ç–µ—Å—Ç

conv_a = active_users_pay[active_users_pay['group'] == 'A']['converted'].sum()
conv_b = active_users_pay[active_users_pay['group'] == 'B']['converted'].sum()
n_a = active_users_pay[active_users_pay['group'] == 'A']['user_id'].count()
n_b = active_users_pay[active_users_pay['group'] == 'B']['user_id'].count()

stat, pval = proportions_ztest([conv_a, conv_b], [n_a, n_b])

print("\nZ-—Ç–µ—Å—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: stat = {:.4f}, p-value = {:.4f}".format(stat, pval))
print("–í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏", "–∑–Ω–∞—á–∏–º—ã" if pval < 0.05 else "–Ω–µ –∑–Ω–∞—á–∏–º—ã")
```

    
    Z-—Ç–µ—Å—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: stat = 0.7630, p-value = 0.4455
    –í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –Ω–µ –∑–Ω–∞—á–∏–º—ã


> #### –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É (CR)
- **H0**: –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤–∞ (p_A = p_B).
- **H1**: –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è (p_A ‚â† p_B).

> –†–∞–∑–Ω–∏—Ü–∞ –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏—è—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∑–Ω–∞—á–∏–º–∞ (p-value > 0.05), –∑–Ω–∞—á–∏—Ç **–º—ã –Ω–µ –æ—Ç–∫–ª–æ–Ω—è–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É** –∏ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –≥—Ä—É–ø–ø–∞—Ö —Ä–∞–≤–Ω—ã. –ù–∞–±–ª—é–¥–∞–µ–º—ã–µ —Ä–∞–∑–ª–∏—á–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å–æ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∫–æ–ª–µ–±–∞–Ω–∏—è–º–∏ –∏–ª–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –≤ —Ä–∞–∑–º–µ—Ä–∞—Ö –≥—Ä—É–ø–ø. –õ–∏–±–æ —Ä–µ–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∫–∏ –Ω–∞ CR –∫—Ä–∞–π–Ω–µ –º–∞–ª–æ.

### –ê–Ω–∞–ª–∏–∑ ARPU (—Å—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º**: –£–∑–Ω–∞—ë–º, –≤—ã—Ä–æ—Å –ª–∏ —Å—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ (ARPU) –≤ –≥—Ä—É–ø–ø–µ B (58.06) –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å A (47.35).

**–ú–µ—Ç–æ–¥—ã**:
- –õ–µ–≤–µ–Ω–∞: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ª–∏ —Ä–∞–∑–±—Ä–æ—Å –¥–æ—Ö–æ–¥–æ–≤.
- T-—Ç–µ—Å—Ç: –ï—Å–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã (p > 0.05), —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å—Ä–µ–¥–Ω–∏–µ.
- –ë—É—Ç—Å—Ç—Ä—ç–ø: –ï—Å–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è (p < 0.05), –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É —Å—Ä–µ–¥–Ω–∏—Ö.

**–ü–æ—á–µ–º—É**: T-—Ç–µ—Å—Ç –Ω–∞–¥—ë–∂–µ–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–æ–∫ (1538 –≤ A, 6803 –≤ B), –±—É—Ç—Å—Ç—Ä—ç–ø —É—Å—Ç–æ–π—á–∏–≤ –∫ –Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–µ—Ä–∞–≤–Ω—ã–º –¥–∏—Å–ø–µ—Ä—Å–∏—è–º.


```python
# ARPU: T-—Ç–µ—Å—Ç
# –ì–∏–ø–æ—Ç–µ–∑—ã:
# H0: ARPU –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤
# H1: ARPU –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è

arpu_a = active_users_pay[active_users_pay['group'] == 'A']['revenue']
arpu_b = active_users_pay[active_users_pay['group'] == 'B']['revenue']
```


```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPU (A): {np.std(arpu_a):.2f}")
print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPU (B): {np.std(arpu_b):.2f}")
```

    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPU (A): 290.40
    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPU (B): 313.75



```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–π

stat_levene_arpu, p_levene_arpu = levene(arpu_a, arpu_b)
print(f"\n–¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞ –¥–ª—è ARPU: stat = {stat_levene_arpu:.4f}, p-value = {p_levene_arpu:.4f}")
equal_var_arpu = p_levene_arpu > 0.05
```

    
    –¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞ –¥–ª—è ARPU: stat = 1.5015, p-value = 0.2205



```python
# T-—Ç–µ—Å—Ç

t_stat_arpu, pval_arpu = ttest_ind(arpu_a, arpu_b, equal_var=equal_var_arpu)
print(f"T-—Ç–µ—Å—Ç –¥–ª—è ARPU: t = {t_stat_arpu:.4f}, p-value = {pval_arpu:.4f}")
print("–í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ ARPU", "–∑–Ω–∞—á–∏–º—ã" if pval_arpu < 0.05 else "–Ω–µ –∑–Ω–∞—á–∏–º—ã")
```

    T-—Ç–µ—Å—Ç –¥–ª—è ARPU: t = -1.2253, p-value = 0.2205
    –í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ ARPU –Ω–µ –∑–Ω–∞—á–∏–º—ã


- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPU (A): 290.40
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPU (B): 313.75
- –¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞ –¥–ª—è ARPU: stat = 1.5015, p-value = 0.2205
- T-—Ç–µ—Å—Ç –¥–ª—è ARPU: t = -1.2253, p-value = 0.2205
- –†–∞–∑–ª–∏—á–∏—è –≤ ARPU –Ω–µ –∑–Ω–∞—á–∏–º—ã

**–í—ã–≤–æ–¥:** –ü–æ—Å–∫–æ–ª—å–∫—É p = 0.2205 > 0.05, –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è T-—Ç–µ—Å—Ç.

> #### –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (ARPU)
- **H0**: –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤ (Œº_A = Œº_B).
- **H1**: –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è (Œº_A ‚â† Œº_B).

> –†–∞–∑–ª–∏—á–∏—è –≤ ARPU —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∑–Ω–∞—á–∏–º—ã (p-value > 0.05), –∑–Ω–∞—á–∏—Ç **–º—ã –ø—Ä–∏–Ω–∏–º–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É** –∏ —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ ARPU –≤ –≥—Ä—É–ø–ø–∞—Ö –Ω–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è. –ù–∞–±–ª—é–¥–∞–µ–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∫–æ–ª–µ–±–∞–Ω–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.

### –ê–Ω–∞–ª–∏–∑ ARPPU (—Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º**: –£–∑–Ω–∞—ë–º, –≤—ã—Ä–æ—Å –ª–∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö (ARPPU) –≤ –≥—Ä—É–ø–ø–µ B (1257.88) –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å A (933.59).

**–ú–µ—Ç–æ–¥—ã**:
- –õ–µ–≤–µ–Ω–∞: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ª–∏ —Ä–∞–∑–±—Ä–æ—Å —á–µ–∫–æ–≤.
- T-—Ç–µ—Å—Ç: –ï—Å–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã (p > 0.05), —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å—Ä–µ–¥–Ω–∏–µ.
- –ë—É—Ç—Å—Ç—Ä—ç–ø: –ï—Å–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è (p < 0.05), –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É —Å—Ä–µ–¥–Ω–∏—Ö.

**–ü–æ—á–µ–º—É**: T-—Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ä–µ–¥–Ω–∏–µ, –±—É—Ç—Å—Ç—Ä—ç–ø —É—Å—Ç–æ–π—á–∏–≤ –∫ –Ω–µ–Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–µ—Ä–∞–≤–Ω—ã–º –¥–∏—Å–ø–µ—Ä—Å–∏—è–º.


```python
# ARPPU: T-—Ç–µ—Å—Ç
# –ì–∏–ø–æ—Ç–µ–∑—ã:
# H0: ARPPU –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤
# H1: ARPPU –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è

rev_a = active_users_pay[(active_users_pay['group'] == 'A') & (active_users_pay['revenue'] > 0)]['revenue']
rev_b = active_users_pay[(active_users_pay['group'] == 'B') & (active_users_pay['revenue'] > 0)]['revenue']
```


```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPPU (A): {np.std(rev_a):.2f}")
print(f"–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPPU (B): {np.std(rev_b):.2f}")
```

    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPPU (A): 914.02
    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPPU (B): 789.60



```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–π

stat_levene_arppu, p_levene_arppu = levene(rev_a, rev_b)
print(f"\n–¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞ –¥–ª—è ARPPU: stat = {stat_levene_arppu:.4f}, p-value = {p_levene_arppu:.4f}")
equal_var_arppu = p_levene_arppu > 0.05
```

    
    –¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞ –¥–ª—è ARPPU: stat = 3.0757, p-value = 0.0803



```python
# T-—Ç–µ—Å—Ç

t_stat_arppu, pval_arppu = ttest_ind(rev_a, rev_b, equal_var=equal_var_arppu)
print(f"T-—Ç–µ—Å—Ç –¥–ª—è ARPPU: t = {t_stat_arppu:.4f}, p-value = {pval_arppu:.4f}")
print("–í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ ARPPU", "–∑–Ω–∞—á–∏–º—ã" if pval_arppu < 0.05 else "–Ω–µ –∑–Ω–∞—á–∏–º—ã")
```

    T-—Ç–µ—Å—Ç –¥–ª—è ARPPU: t = -3.1338, p-value = 0.0019
    –í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ ARPPU –∑–Ω–∞—á–∏–º—ã


- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPPU (A): 914.02
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ARPPU (B): 789.60
- –¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞ –¥–ª—è ARPPU: stat = 3.0757, p-value = 0.0803
- T-—Ç–µ—Å—Ç –¥–ª—è ARPPU: t = -3.1338, p-value = 0.0019
- –†–∞–∑–ª–∏—á–∏—è –≤ ARPPU –∑–Ω–∞—á–∏–º—ã

**–í—ã–≤–æ–¥:** –ü–æ—Å–∫–æ–ª—å–∫—É p = 0.0803 > 0.05, –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è T-—Ç–µ—Å—Ç.

> #### –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (ARPPU)
- **H0**: –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B –æ–¥–∏–Ω–∞–∫–æ–≤ (Œº_A = Œº_B).
- **H1**: –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–∞—Ö A –∏ B —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è (Œº_A ‚â† Œº_B).
    
> –†–∞–∑–ª–∏—á–∏—è –≤ ARPPU —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã (p-value < 0.05), –∑–Ω–∞—á–∏—Ç **–º—ã –æ—Ç–∫–ª–æ–Ω—è–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –∏ –ø—Ä–∏–Ω–∏–º–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é**, —á—Ç–æ ARPPU –≤ –≥—Ä—É–ø–ø–∞—Ö —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω—ã–º –¥–ª—è –±–∏–∑–Ω–µ—Å–∞, —Ç–∞–∫ –∫–∞–∫ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ ARPPU –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–º—É —É–≤–µ–ª–∏—á–µ–Ω–∏—é –¥–æ—Ö–æ–¥–æ–≤.


```python
# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –∏ –±–æ–∫—Å–ø–ª–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–ª–∏—á–∏—è –≤ —á–µ–∫–∞—Ö –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞
plt.figure(figsize=(10, 6))
sns.histplot(data=active_users_pay[active_users_pay['revenue'] > 0], x='revenue', hue='group', bins=30, kde=True)
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (ARPPU)')
plt.xlabel('–î–æ—Ö–æ–¥ (revenue)')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
plt.show()

# –ë–æ–∫—Å–ø–ª–æ—Ç
plt.figure(figsize=(10, 6))
sns.boxplot(x='group', y='revenue', data=active_users_pay[active_users_pay['revenue'] > 0])
plt.title('–ë–æ–∫—Å–ø–ª–æ—Ç –¥–æ—Ö–æ–¥–æ–≤ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (ARPPU)')
plt.xlabel('–ì—Ä—É–ø–ø–∞')
plt.ylabel('–î–æ—Ö–æ–¥ (revenue)')
plt.show()
```


![png](output_67_0.png)



![png](output_67_1.png)


**2. –ò–º–µ—é—Ç—Å—è –ª–∏ —Ä–∞–∑–ª–∏—á–∏—è –≤ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö –∏ —Å —á–µ–º –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã?**

**–ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏**:
- **CR**: A = 5.07% (78/1538), B = 4.62% (314/6803). –ö–æ–Ω–≤–µ—Ä—Å–∏—è –Ω–∏–∂–µ –≤ B.
- **ARPU**: A = 47.35, B = 58.06. –í—ã—à–µ –≤ B, –Ω–æ –Ω–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ.
- **ARPPU**: A = 933.59, B = 1257.88. –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ –≤ B.

**–ü—Ä–∏—á–∏–Ω—ã**:
- **–†–æ—Å—Ç ARPPU**: –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —É–ø—Ä–æ—â–∞–µ—Ç –∫—Ä—É–ø–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞—Ä–∏—Ñ ~1900, –≤–∏–¥–µ–Ω –Ω–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ).
- **–°–Ω–∏–∂–µ–Ω–∏–µ CR**: –ù–µ–ø—Ä–∏–≤—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–∂–µ—Ç –æ—Ç–ø—É–≥–∏–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –º–µ–ª–∫–∏—Ö –ø–æ–∫—É–ø–æ–∫.
- **ARPU –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —Ä–æ—Å—Ç ARPPU, –ø–æ—ç—Ç–æ–º—É –æ–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –Ω–µ —Ä–∞—Å—Ç—ë—Ç.

**3. –Ø–≤–ª—è—é—Ç—Å—è –ª–∏ —ç—Ç–∏ —Ä–∞–∑–ª–∏—á–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º–∏?**
- **–ö–æ–Ω–≤–µ—Ä—Å–∏—è (CR):**
p-value = 0.4455 (z-—Ç–µ—Å—Ç). –†–∞–∑–ª–∏—á–∏—è –Ω–µ –∑–Ω–∞—á–∏–º—ã. –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- **ARPU:**
p-value = 0.2205 (T-—Ç–µ—Å—Ç, –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã). –†–∞–∑–ª–∏—á–∏—è –Ω–µ –∑–Ω–∞—á–∏–º—ã. –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∑–Ω–∞—á–∏–º–æ–º—É —Ä–æ—Å—Ç—É –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **ARPPU:**
p-value = 0.0019 (T-—Ç–µ—Å—Ç, –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã). –†–∞–∑–ª–∏—á–∏—è –∑–Ω–∞—á–∏–º—ã. –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É:**

**–ê–Ω–∞–ª–∏–∑**:
- **–ü–ª—é—Å—ã**: –ó–Ω–∞—á–∏–º—ã–π —Ä–æ—Å—Ç ARPPU (933.59 ‚Üí 1257.88, p = 0.0019) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–ª–∞—Ç—è—â–∏–µ —Ç—Ä–∞—Ç—è—Ç –±–æ–ª—å—à–µ.
- **–ú–∏–Ω—É—Å—ã**: ARPU –Ω–µ –≤—ã—Ä–æ—Å (p = 0.2205), –∫–æ–Ω–≤–µ—Ä—Å–∏—è —Å–ª–µ–≥–∫–∞ —Å–Ω–∏–∑–∏–ª–∞—Å—å (p = 0.4455, –Ω–µ –∑–Ω–∞—á–∏–º–æ). –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –Ω–µ —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å.

**–†–∏—Å–∫–∏**: –°–Ω–∏–∂–µ–Ω–∏–µ CR (4.62% vs 5.07%) –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ UX-–ø—Ä–æ–±–ª–µ–º—ã –¥–ª—è –º–µ–ª–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∫—É –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü—Ä–æ–≤–µ—Å—Ç–∏:
1. –°–µ–≥–º–µ–Ω—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø—Ä–µ–º–∏—É–º-–ø—Ä–æ–¥—É–∫—Ç–æ–≤).
2. UX-—Ç–µ—Å—Ç—ã –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –º–µ–ª–∫–∏—Ö –ø–æ–∫—É–ø–æ–∫.
3. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π —Ç–µ—Å—Ç —Å –±–æ–ª—å—à–µ–π –≤—ã–±–æ—Ä–∫–æ–π –¥–ª—è A (1538 vs 6803).
4. –ü—Ä–æ–≤–µ—Ä–∫—É 149 –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤ (–∞–≤—Ç–æ–ø–ª–∞—Ç–µ–∂–∏).

**–ò—Ç–æ–≥**: –†–æ—Å—Ç ARPPU –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ–Ω, –Ω–æ —Å–Ω–∏–∂–µ–Ω–∏–µ CR –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–æ—Å—Ç–∞ ARPU —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –º–µ—Ö–∞–Ω–∏–∫–∏.

### –û–±—â–∏–π –≤—ã–≤–æ–¥

–í —Ö–æ–¥–µ A/B-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∫–∏ –æ–ø–ª–∞—Ç—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É (CR), —Å—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (ARPU) –∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (ARPPU).

**–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –æ–ø–ª–∞—Ç—É (CR):**

–ì—Ä—É–ø–ø–∞ A: 5.07% (78 –∏–∑ 1538 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
–ì—Ä—É–ø–ø–∞ B: 4.62% (314 –∏–∑ 6803 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
Z-—Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–π: stat = 0.7630, p-value = 0.4455.

> –í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –Ω–µ –∑–Ω–∞—á–∏–º—ã (p > 0.05). –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥–æ–ª—é –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –õ—ë–≥–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –≥—Ä—É–ø–ø–µ B (4.62% –ø—Ä–æ—Ç–∏–≤ 5.07%) –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º –∏–ª–∏ —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ–ø—Ä–∏–≤—ã—á–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

**–°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (ARPU):**

–ì—Ä—É–ø–ø–∞ A: 47.35.
–ì—Ä—É–ø–ø–∞ B: 58.06.
–¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞: stat = 1.5015, p-value = 0.2205 (–¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã).
T-—Ç–µ—Å—Ç: t = -1.2253, p-value = 0.2205.
> –í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ ARPU –Ω–µ –∑–Ω–∞—á–∏–º—ã (p > 0.05). –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–±—â—É—é –≤—ã—Ä—É—á–∫—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ß–∏—Å–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç ARPU –≤ –≥—Ä—É–ø–ø–µ B –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç—Å—è —Å–Ω–∏–∂–µ–Ω–∏–µ–º –∫–æ–Ω–≤–µ—Ä—Å–∏–∏.

**–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (ARPPU):**

–ì—Ä—É–ø–ø–∞ A: 933.59.
–ì—Ä—É–ø–ø–∞ B: 1257.88.
–¢–µ—Å—Ç –õ–µ–≤–µ–Ω–∞: stat = 3.0757, p-value = 0.0803 (–¥–∏—Å–ø–µ—Ä—Å–∏–∏ —Ä–∞–≤–Ω—ã).
T-—Ç–µ—Å—Ç: t = -3.1338, p-value = 0.0019.
> –í—ã–≤–æ–¥: –†–∞–∑–ª–∏—á–∏—è –≤ ARPPU –∑–Ω–∞—á–∏–º—ã (p < 0.05). –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–µ—Ä–æ—è—Ç–Ω–æ, –∑–∞ —Å—á—ë—Ç —É–ø—Ä–æ—â–µ–Ω–∏—è –∫—Ä—É–ø–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞—Ä–∏—Ñ –æ–∫–æ–ª–æ 1900, –≤–∏–¥–µ–Ω –Ω–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ).


##### –ê–Ω–æ–º–∞–ª–∏–∏ –≤ –¥–∞–Ω–Ω—ã—Ö:

–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ 149 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –æ–ø–ª–∞—Ç–∞–º–∏, –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã–µ –≤ –¥–Ω–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞. –≠—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ –∞–Ω–∞–ª–∏–∑–∞, —Ç–∞–∫ –∫–∞–∫ –∏—Ö –æ–ø–ª–∞—Ç—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Å–≤—è–∑–∞–Ω—ã —Å –∞–≤—Ç–æ–ø–ª–∞—Ç–µ–∂–∞–º–∏ –∏–ª–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏, –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–º–∏—Å—è –∫ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π –º–µ—Ö–∞–Ω–∏–∫–µ.

##### –ü—Ä–∏—á–∏–Ω—ã —Ä–∞–∑–ª–∏—á–∏–π

–†–æ—Å—Ç ARPPU: –ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —É–ø—Ä–æ—â–∞–µ—Ç –æ–ø–ª–∞—Ç—É –∫—Ä—É–ø–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–ª–∏ —Å—Ç–∏–º—É–ª–∏—Ä—É–µ—Ç –≤—ã–±–æ—Ä –±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–º–∏—É–º-—Ç–∞—Ä–∏—Ñ –æ–∫–æ–ª–æ 1900).
–°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏: –ù–µ–ø—Ä–∏–≤—ã—á–Ω–æ—Å—Ç—å –∏–ª–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –º–æ–∂–µ—Ç –æ—Ç–ø—É–≥–∏–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–∫–ª–æ–Ω–Ω—ã—Ö –∫ –º–µ–ª–∫–∏–º –ø–æ–∫—É–ø–∫–∞–º.
ARPU –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —Ä–æ—Å—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞, —á—Ç–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–µ –∑–Ω–∞—á–∏–º–æ –≤—ã—Ä–∞—Å—Ç–∏.

##### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

–ù–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ –æ–ø–ª–∞—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–Ω–∞—á–∏–º—ã–π —Ä–æ—Å—Ç ARPPU (—Å 933.59 –¥–æ 1257.88, p = 0.0019), —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –µ—ë —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å—É–º–º—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å—Ä–µ–¥–∏ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –û–¥–Ω–∞–∫–æ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –≥—Ä—É–ø–ø–µ B –Ω–µ–º–Ω–æ–≥–æ –Ω–∏–∂–µ (4.62% –ø—Ä–æ—Ç–∏–≤ 5.07%, p = 0.4455, –Ω–µ –∑–Ω–∞—á–∏–º–æ), –∞ ARPU –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–Ω–∞—á–∏–º–æ–≥–æ —Ä–æ—Å—Ç–∞ (58.06 –ø—Ä–æ—Ç–∏–≤ 47.35, p = 0.2205).

##### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: 
–ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É –Ω–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∑–Ω–∞—á–∏–º–æ–º—É —Ä–æ—Å—Ç—É –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ (ARPU). 

> –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
–ü—Ä–æ–≤–µ—Å—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑, —á—Ç–æ–±—ã –≤—ã—è–≤–∏—Ç—å –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–∫—É–ø–∞—é—â–∏—Ö –ø—Ä–µ–º–∏—É–º-–ø—Ä–æ–¥—É–∫—Ç—ã), –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞, –∏ –≤–Ω–µ–¥—Ä–∏—Ç—å –µ—ë –≤—ã–±–æ—Ä–æ—á–Ω–æ.
–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—ã —Å–Ω–∏–∂–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, A/B-—Ç–µ—Å—Ç —Å —É–ø—Ä–æ—â—ë–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º).
–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ç–µ—Å—Ç —Å –±–æ–ª—å—à–µ–π –≤—ã–±–æ—Ä–∫–æ–π –¥–ª—è –≥—Ä—É–ø–ø—ã A (1538 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–æ—Ç–∏–≤ 6803 –≤ –≥—Ä—É–ø–ø–µ B), —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å.
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å 149 –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞—Ç–µ–ª—å—â–∏–∫–æ–≤ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∞–≤—Ç–æ–ø–ª–∞—Ç–µ–∂–µ–π –∏–ª–∏ –æ—à–∏–±–æ–∫ –≤ –¥–∞–Ω–Ω—ã—Ö.

**–ò—Ç–æ–≥: –†–æ—Å—Ç ARPPU –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ–Ω, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–æ—Å—Ç–∞ ARPU –∏ –ª—ë–≥–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –º–µ—Ö–∞–Ω–∏–∫–∏ –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º.**

# –ó–∞–¥–∞–Ω–∏–µ 2. SQL

### 2.1 –û—á–µ–Ω—å —É—Å–µ—Ä–¥–Ω—ã–µ —É—á–µ–Ω–∏–∫–∏.

#### 2.1.1 –£—Å–ª–æ–≤–∏–µ

–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã —Å–æ—Å—Ç–æ—è—Ç –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Ä–æ–∫–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞–ª–µ–Ω—å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π. –ö–∞–∂–¥–æ–µ —Ç–∞–∫–æ–µ –º–∞–ª–µ–Ω—å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è "–≥–æ—Ä–æ—à–∏–Ω–æ–π".

–ù–∞–∑–æ–≤—ë–º –æ—á–µ–Ω—å —É—Å–µ—Ä–¥–Ω—ã–º —É—á–µ–Ω–∏–∫–æ–º —Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü `–ø—Ä–∞–≤–∏–ª—å–Ω–æ` —Ä–µ—à–∏–ª 20 –≥–æ—Ä–æ—à–∏–Ω.

#### 2.1.2 –ó–∞–¥–∞—á–∞

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–ø–∏—Å–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –¥–∞—Å—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—á–µ–Ω—å —É—Å–µ—Ä–¥–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.NB! –ü–æ–¥ —É—Å–µ—Ä–¥–Ω—ã–º —Å—Ç—É–¥–µ–Ω—Ç–æ–º –º—ã –ø–æ–Ω–∏–º–∞–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à–∏–ª 20 –∑–∞–¥–∞—á –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü.

# SQL –∫–æ–¥ –∑–∞–ø—Ä–æ—Å–∞


```
SELECT COUNT(DISTINCT st_id) AS very_diligent_students
FROM (
    SELECT 
        st_id,
        DATE_TRUNC('month', timest) AS month,
        COUNT(*) AS correct_peas
    FROM peas
    WHERE correct = TRUE
    GROUP BY st_id, DATE_TRUNC('month', timest)
    HAVING COUNT(*) >= 20
) AS sub;

```

### –í—ã–¥–∞—á–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É: very_diligent_students 136	

### –ü–æ—è—Å–Ω–µ–Ω–∏–µ:

>1. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π SELECT:
 - –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ —Å—Ç—É–¥–µ–Ω—Ç—É –∏ –º–µ—Å—è—Ü—É (–∏—Å–ø–æ–ª—å–∑—É–µ–º DATE_TRUNC('month', timest) –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –º–µ—Å—è—Ü–∞);
 - —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à—ë–Ω–Ω—ã—Ö –≥–æ—Ä–æ—à–∏–Ω –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã (—Å—Ç—É–¥–µ–Ω—Ç, –º–µ—Å—è—Ü);
 - —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–µ –ø–∞—Ä—ã, –≥–¥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ >= 20 (—É—Å–µ—Ä–¥–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –∑–∞ –º–µ—Å—è—Ü).
2.	–í–Ω–µ—à–Ω–∏–π SELECT:
 - —Å—á–∏—Ç–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (COUNT(DISTINCT st_id)), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø–∞–ª–∏ —Ö–æ—Ç—è –±—ã –≤ –æ–¥–Ω—É —Ç–∞–∫—É—é –ø–∞—Ä—É (—Ç.–µ. –∑–∞ –∫–∞–∫–æ–π-—Ç–æ –º–µ—Å—è—Ü –±—ã–ª–∏ —É—Å–µ—Ä–¥–Ω—ã–º–∏).

### 2.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤–æ—Ä–æ–Ω–∫–∏

#### 2.2.1 –£—Å–ª–æ–≤–∏–µ

–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø—Ä–æ–π—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞–º –∫—É—Ä—Å—ã –ø–æ –º–æ–¥–µ–ª–∏ trial: —Å—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ –ª–∏—à—å 30 –≥–æ—Ä–æ—à–∏–Ω –≤ –¥–µ–Ω—å. –î–ª—è –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–¥–∞–Ω–∏–π –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ —Å—Ç—É–¥–µ–Ω—Ç—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–æ–±—Ä–µ—Å—Ç–∏ –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø. –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ–ª–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç, –≥–¥–µ –±—ã–ª –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–æ–≤—ã–π —ç–∫—Ä–∞–Ω –æ–ø–ª–∞—Ç—ã.

#### 2.2.2 –ó–∞–¥–∞—á–∞

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤—ã–≥—Ä—É–∑–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

- ARPU 
- ARPAU 
- CR –≤ –ø–æ–∫—É–ø–∫—É 
- –°R –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø–æ–∫—É–ø–∫—É 
- CR –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ (subject = ‚Äômath‚Äô) –≤ –ø–æ–∫—É–ø–∫—É –∫—É—Ä—Å–∞ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ
- ARPU —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–ø–∞–≤—à–∏—Ö –≤ –≥—Ä—É–ø–ø—ã.

`–ê–∫—Ç–∏–≤–Ω—ã–º` —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è —Ä–µ—à–∏–≤—à–∏–π `–±–æ–ª—å—à–µ 10 –∑–∞–¥–∞—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ –ª—é–±—ã—Ö –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ö`.

`–ê–∫—Ç–∏–≤–Ω—ã–º` –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è —Ä–µ—à–∏–≤—à–∏–π `2 –∏–ª–∏ –±–æ–ª—å—à–µ –∑–∞–¥–∞—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ`.

```
WITH 
-- 1. –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
all_users AS ( SELECT st_id, test_grp FROM studs ),
-- 2. –í—Å–µ –ø–æ–∫—É–ø–∫–∏
purchases AS ( SELECT st_id, money, subject FROM final_project_check ),
-- 3. –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–±–æ–ª–µ–µ 10 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π)
active_users AS ( SELECT st_id FROM peas WHERE correct = TRUE GROUP BY st_id HAVING COUNT(*) > 10 ),
-- 4. –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ (2+ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π –ø–æ math)
active_math_users AS ( SELECT st_id FROM peas WHERE correct = TRUE AND subject = 'math' GROUP BY st_id HAVING COUNT(*) >= 2 ),
-- 5. –ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ math –∫—É—Ä—Å–∞
math_buyers AS ( SELECT st_id FROM final_project_check WHERE subject = 'math' )

-- –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á—ë—Ç

SELECT u.test_grp,
-- ARPU: total revenue / total users
COALESCE(SUM(p.money), 0) * 1.0 / COUNT(DISTINCT u.st_id) AS ARPU,

-- ARPAU: total revenue / active users
COALESCE(SUM(p.money), 0) * 1.0 / NULLIF(COUNT(DISTINCT au.st_id), 0) AS ARPAU,

-- CR –≤ –ø–æ–∫—É–ø–∫—É: % –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –ø–æ–∫—É–ø–∫—É
COUNT(DISTINCT p.st_id) * 1.0 / COUNT(DISTINCT u.st_id) AS CR_total,

-- CR –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ø–æ–∫—É–ø–∫—É
COUNT(DISTINCT CASE WHEN au.st_id IS NOT NULL AND p.st_id IS NOT NULL THEN p.st_id END) * 1.0
/ NULLIF(COUNT(DISTINCT au.st_id), 0) AS CR_active,

-- CR –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ math –≤ –ø–æ–∫—É–ø–∫—É math –∫—É—Ä—Å–∞
COUNT(DISTINCT CASE WHEN amu.st_id IS NOT NULL AND mb.st_id IS NOT NULL THEN mb.st_id END) * 1.0
/ NULLIF(COUNT(DISTINCT amu.st_id), 0) AS CR_active_math
FROM all_users u
LEFT JOIN purchases p ON u.st_id = p.st_id LEFT JOIN active_users au ON u.st_id = au.st_id LEFT JOIN active_math_users amu ON u.st_id = amu.st_id LEFT JOIN math_buyers mb ON u.st_id = mb.st_id
GROUP BY u.test_grp ORDER BY u.test_grp;
```

–ü–æ—è—Å–Ω–µ–Ω–∏–µ:

>- ARPU ‚Äî –æ–±—â–∏–π –¥–æ—Ö–æ–¥ –ø–æ –≥—Ä—É–ø–ø–µ / –æ–±—â–µ–µ —á–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–µ
- ARPAU ‚Äî –æ–±—â–∏–π –¥–æ—Ö–æ–¥ –ø–æ –≥—Ä—É–ø–ø–µ / —á–∏—Å–ª–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (>10 –∑–∞–¥–∞—á –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- CR –≤ –ø–æ–∫—É–ø–∫—É ‚Äî % –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —á—Ç–æ-–ª–∏–±–æ –∫—É–ø–∏–ª–∏
- CR –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ø–æ–∫—É–ø–∫—É ‚Äî % –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —á—Ç–æ-–ª–∏–±–æ –∫—É–ø–∏–ª–∏
- CR –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ math ‚Üí –≤ –ø–æ–∫—É–ø–∫—É math –∫—É—Ä—Å–∞ ‚Äî % –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ math –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∫—É–ø–∏–ª–∏ math –∫—É—Ä—Å

#### –°–æ–±–µ—Ä–µ–º –≤ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏.


```python
data = {
    "group": ["control", "pilot"],
    "arpu": [4540.98, 11508.47],
    "arpau": [10393.70, 29739.58],
    "cr_total_user": [4.92, 10.85],
    "cr_active_user": [11.02, 26.04],
    "cr_math_user": [6.12, 9.52]
}

df = pd.DataFrame(data)

df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>arpu</th>
      <th>arpau</th>
      <th>cr_total_user</th>
      <th>cr_active_user</th>
      <th>cr_math_user</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>control</td>
      <td>4540.98</td>
      <td>10393.70</td>
      <td>4.92</td>
      <td>11.02</td>
      <td>6.12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pilot</td>
      <td>11508.47</td>
      <td>29739.58</td>
      <td>10.85</td>
      <td>26.04</td>
      <td>9.52</td>
    </tr>
  </tbody>
</table>
</div>




```python
–ù–∞–∑–≤–∞–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞	–¢–∏–ø –∞—Ç—Ä–∏–±—É—Ç–∞	–°–º—ã—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
st_id	int	ID —É—á–µ–Ω–∏–∫–∞
timest	timestamp	–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏
correct	bool	–ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ä–µ—à–µ–Ω–∞ –≥–æ—Ä–æ—à–∏–Ω–∞?
subject	text	–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≥–æ—Ä–æ—à–∏–Ω–∞
```


      File "<ipython-input-42-7c40748dbd4e>", line 1
        –ù–∞–∑–≤–∞–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞	–¢–∏–ø –∞—Ç—Ä–∏–±—É—Ç–∞	–°–º—ã—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                        ^
    SyntaxError: invalid syntax



# –ó–∞–¥–∞–Ω–∏–µ 3. Python

### 3.1 –ó–∞–¥–∞—á–∞

#### 3.1.1 
–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ groups_add.csv (–∑–∞–≥–æ–ª–æ–≤–∫–∏ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è) –∏ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏.


```python
import pandas as pd
import requests
from urllib.parse import urlencode

def load_data(url: str, sep: str) -> pd.DataFrame:
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç CSV-—Ñ–∞–π–ª —Å –ø—É–±–ª–∏—á–Ω–æ–≥–æ URL –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
      url  - –ø—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞
      sep  - —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –≤ CSV-—Ñ–∞–π–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ',' –∏–ª–∏ ';')
      
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
      pandas DataFrame —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
      –ï—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç —Å—Ç–æ–ª–±—Ü–∞ 'id', –Ω–æ –µ—Å—Ç—å 'student_id', –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –µ–≥–æ –≤ 'id'.
    """
    # –§–æ—Ä–º–∏—Ä—É–µ–º API-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä—è–º–æ–π —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
    api_path = 'https://cloud-api.yandex.net/v1/disk/public/resources/download?'
    full_url = api_path + urlencode({'public_key': url})
    
    # –í—ã–ø–æ–ª–Ω—è–µ–º GET-–∑–∞–ø—Ä–æ—Å –∫ API –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞
    response = requests.get(full_url)
    response.raise_for_status()  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω—ã–π
    
    # –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è CSV —Ñ–∞–π–ª–∞
    download_url = response.json().get('href')
    if not download_url:
        raise ValueError("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å URL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è")
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º CSV –≤ DataFrame
    df = pd.read_csv(download_url, sep=sep)
    
    # –ï—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç —Å—Ç–æ–ª–±—Ü–∞ 'id', –Ω–æ –µ—Å—Ç—å 'student_id' ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏
    if 'id' not in df.columns and 'student_id' in df.columns:
        df.rename(columns={'student_id': 'id'}, inplace=True)
    
    return df

def update_metrics(public_keys: dict, groups_add_rename_map: dict = None) -> pd.DataFrame:
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏.
    
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
      public_keys - —Å–ª–æ–≤–∞—Ä—å —Å –∫–ª—é—á–∞–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏: [URL, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å CSV].
      groups_add_rename_map - —Å–ª–æ–≤–∞—Ä—å –¥–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ groups_add,
                             –µ—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, {'group': 'grp'}).
                             
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
      DataFrame —Å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º:
        - user_count: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–µ
        - payds_count: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        - revenue: —Å—É–º–º–∞—Ä–Ω—ã–π –¥–æ—Ö–æ–¥
        - CR: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø–ª–∞—Ç—è—â–∏—Ö (–≤ %)
        - ARPU: –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        - ARPPU: –¥–æ—Ö–æ–¥ –Ω–∞ –ø–ª–∞—Ç—è—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç —Å –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    groups = load_data(public_keys['groups'][0], public_keys['groups'][1])
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç —Å –≥—Ä—É–ø–ø–∞–º–∏ (–Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è)
    groups_add = load_data(public_keys['groups_add'][0], public_keys['groups_add'][1])
    
    # –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ, —á—Ç–æ–±—ã —Å–æ–≤–ø–∞–ª–∏ —Å –æ—Å–Ω–æ–≤–Ω—ã–º
    if groups_add_rename_map:
        groups_add = groups_add.rename(columns=groups_add_rename_map)
    
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç—ã —Å –≥—Ä—É–ø–ø–∞–º–∏ (–≤ –æ–¥–∏–Ω DataFrame)
    groups_full = pd.concat([groups, groups_add], ignore_index=True)
    
    # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –∞–∫—Ç–∏–≤–Ω—ã–º —Å—Ç—É–¥–µ–Ω—Ç–∞–º –∏ –ø–æ –∏—Ö –ø–ª–∞—Ç–µ–∂–∞–º
    active_studs = load_data(public_keys['active_studs'][0], public_keys['active_studs'][1])
    checks = load_data(public_keys['checks'][0], public_keys['checks'][1])
    
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å –∏—Ö –ø–ª–∞—Ç–µ–∂–∞–º–∏ –ø–æ —Å—Ç–æ–ª–±—Ü—É 'id', –∑–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –Ω—É–ª—è–º–∏ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–ª–∞—Ç–µ–∂–∞)
    active_studs = active_studs.merge(checks, how='left', on='id').fillna(0)
    
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º —Å –∏—Ö –≥—Ä—É–ø–ø–∞–º–∏
    final_df = active_studs.merge(groups_full, how='left', on='id')
    
    # –°–æ–∑–¥–∞—ë–º –±—É–ª–µ–≤ —Å—Ç–æ–ª–±–µ—Ü 'paid' - True, –µ—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ø–ª–∞—Ç–µ–∂ (rev > 0)
    final_df['paid'] = final_df['rev'] > 0
    
    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –≥—Ä—É–ø–ø–∞–º –∏ —Å—á–∏—Ç–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏:
    # - user_count: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–µ
    # - payds_count: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö (True –≤ 'paid')
    # - revenue: —Å—É–º–º–∞—Ä–Ω—ã–π –¥–æ—Ö–æ–¥ (—Å—É–º–º–∞ –ø–æ 'rev')
    result = final_df.groupby('grp').agg(
        user_count=('id', 'count'),
        payds_count=('paid', 'sum'),
        revenue=('rev', 'sum')
    ).reset_index()
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
    # - CR (conversion rate) ‚Äî –¥–æ–ª—è –ø–ª–∞—Ç—è—â–∏—Ö –≤ –≥—Ä—É–ø–ø–µ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    # - ARPU ‚Äî –¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (revenue / user_count)
    # - ARPPU ‚Äî –¥–æ—Ö–æ–¥ –Ω–∞ –ø–ª–∞—Ç—è—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (revenue / payds_count)
    result['CR'] = round(result['payds_count'] / result['user_count'] * 100, 2)
    result['ARPU'] = round(result['revenue'] / result['user_count'], 2)
    result['ARPPU'] = round(result['revenue'] / result['payds_count'], 2)
    
    return result

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
public_keys = {
    'groups': ['https://disk.yandex.ru/d/UhyYx41rTt3clQ', ';'],
    'groups_add': ['https://disk.yandex.ru/d/5Kxrz02m3IBUwQ', ','],
    'active_studs': ['https://disk.yandex.ru/d/Tbs44Bm6H_FwFQ', ','],
    'checks': ['https://disk.yandex.ru/d/pH1q-VqcxXjsVA', ';']
}

# –ï—Å–ª–∏ –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ groups_add –Ω–∞–∑–≤–∞–Ω–∏—è –æ—Ç–ª–∏—á–∞—é—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä 'group' –≤–º–µ—Å—Ç–æ 'grp',
# —Ç–æ –ø–µ—Ä–µ–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å —Å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º –∫–æ–ª–æ–Ω–æ–∫
rename_map = {'group': 'grp'}  # –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è

# –ü–æ–ª—É—á–∞–µ–º –∏—Ç–æ–≥–æ–≤—ã–π DataFrame —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
metrics_result = update_metrics(public_keys, groups_add_rename_map=rename_map)

metrics_result
```

#### 3.1.2 –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –ø–æ–ª—É—á–∞–µ–º—ã–º –º–µ—Ç—Ä–∏–∫–∞–º.

	‚Ä¢	–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (user_count) –ø–æ –≥—Ä—É–ø–ø–∞–º
	‚Ä¢	–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö (payds_count) –ø–æ –≥—Ä—É–ø–ø–∞–º
	‚Ä¢	–î–æ—Ö–æ–¥ (revenue) –ø–æ –≥—Ä—É–ø–ø–∞–º
	‚Ä¢	–ö–æ–Ω–≤–µ—Ä—Å–∏—é (CR)
	‚Ä¢	ARPU –∏ ARPPU


```python
import matplotlib.pyplot as plt
import seaborn as sns

def plot_metrics(metrics_df: pd.DataFrame):
    """
    –°—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º –∏–∑ DataFrame.
    
    –û–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ –≤ df –µ—Å—Ç—å —Å—Ç–æ–ª–±–µ—Ü 'grp' –∏ –º–µ—Ç—Ä–∏–∫–∏:
    'user_count', 'payds_count', 'revenue', 'CR', 'ARPU', 'ARPPU'.
    """
    sns.set_style("whitegrid")
    
    fig, axes = plt.subplots(3, 2, figsize=(14, 12))
    
    # 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
    sns.barplot(data=metrics_df, x='grp', y='user_count', ax=axes[0,0], palette='Blues_d')
    axes[0,0].set_title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (user_count)')
    axes[0,0].set_xlabel('')
    axes[0,0].set_ylabel('–ß–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
    
    # 2. –ü–ª–∞—Ç—è—â–∏–µ
    sns.barplot(data=metrics_df, x='grp', y='payds_count', ax=axes[0,1], palette='Greens_d')
    axes[0,1].set_title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞—Ç—è—â–∏—Ö (payds_count)')
    axes[0,1].set_xlabel('')
    axes[0,1].set_ylabel('–ß–∏—Å–ª–æ –ø–ª–∞—Ç—è—â–∏—Ö')
    
    # 3. –î–æ—Ö–æ–¥
    sns.barplot(data=metrics_df, x='grp', y='revenue', ax=axes[1,0], palette='Oranges_d')
    axes[1,0].set_title('–î–æ—Ö–æ–¥ (revenue)')
    axes[1,0].set_xlabel('')
    axes[1,0].set_ylabel('–°—É–º–º–∞—Ä–Ω—ã–π –¥–æ—Ö–æ–¥')
    
    # 4. –ö–æ–Ω–≤–µ—Ä—Å–∏—è CR (%)
    sns.barplot(data=metrics_df, x='grp', y='CR', ax=axes[1,1], palette='Purples_d')
    axes[1,1].set_title('–ö–æ–Ω–≤–µ—Ä—Å–∏—è (CR), %')
    axes[1,1].set_xlabel('')
    axes[1,1].set_ylabel('–ö–æ–Ω–≤–µ—Ä—Å–∏—è (%)')
    
    # 5. ARPU
    sns.barplot(data=metrics_df, x='grp', y='ARPU', ax=axes[2,0], palette='RdPu')
    axes[2,0].set_title('ARPU (–¥–æ—Ö–æ–¥ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)')
    axes[2,0].set_xlabel('–ì—Ä—É–ø–ø–∞')
    axes[2,0].set_ylabel('ARPU')
    
    # 6. ARPPU
    sns.barplot(data=metrics_df, x='grp', y='ARPPU', ax=axes[2,1], palette='RdYlBu')
    axes[2,1].set_title('ARPPU (–¥–æ—Ö–æ–¥ –Ω–∞ –ø–ª–∞—Ç—è—â–µ–≥–æ)')
    axes[2,1].set_xlabel('–ì—Ä—É–ø–ø–∞')
    axes[2,1].set_ylabel('ARPPU')
    
    plt.tight_layout()
    plt.show()
```


```python
plot_metrics(metrics_result)
```
